{
  "products": [
    {
      "name": "testing-deploy-arch-ibm-observability",
      "label": "Testing-Observability",
      "product_kind": "solution",
      "tags": [
        "ibm_created",
        "logging_monitoring"
      ],
      "short_description": "Configures IBM Cloud Observability resources",
      "long_description": "Solutions that support configuring IBM Cloud Observability resources for logging, monitoring, and activity tracking.",
      "offering_docs_url": "https://github.com/terraform-ibm-modules/terraform-ibm-observability-da/blob/main/README.md",
      "offering_icon_url": "https://raw.githubusercontent.com/terraform-ibm-modules/terraform-ibm-observability-da/main/images/observability-icon.svg",
      "flavors": [
        {
          "label": "Instances",
          "name": "instances",
          "install_type": "extension",
          "working_directory": "solutions/instances",
          "licenses": [
            {
              "id": "LICENSE",
              "name": "LICENSE",
              "type": "text/plain",
              "description": "LICENSE"
            }
          ],
          "iam_permissions": [
            {
              "service_name": "atracker",
              "role_crns": [
                "crn:v1:bluemix:public:iam::::serviceRole:Writer",
                "crn:v1:bluemix:public:iam::::role:Editor"
              ]
            },
            {
              "role_crns": [
                "crn:v1:bluemix:public:iam::::serviceRole:Manager",
                "crn:v1:bluemix:public:iam::::role:Editor"
              ],
              "service_name": "logdna"
            },
            {
              "role_crns": [
                "crn:v1:bluemix:public:iam::::serviceRole:Manager",
                "crn:v1:bluemix:public:iam::::role:Editor"
              ],
              "service_name": "hs-crypto"
            },
            {
              "role_crns": [
                "crn:v1:bluemix:public:iam::::serviceRole:Manager",
                "crn:v1:bluemix:public:iam::::role:Editor"
              ],
              "service_name": "kms"
            },
            {
              "role_crns": [
                "crn:v1:bluemix:public:iam::::serviceRole:Manager",
                "crn:v1:bluemix:public:iam::::role:Editor"
              ],
              "service_name": "sysdig-monitor"
            },
            {
              "role_crns": [
                "crn:v1:bluemix:public:iam::::serviceRole:Manager",
                "crn:v1:bluemix:public:iam::::role:Editor"
              ],
              "service_name": "cloud-object-storage"
            }
          ],
          "compliance": {
            "authority": "scc-v3",
            "profiles": [
              {
                "profile_name": "IBM Cloud Framework for Financial Services",
                "profile_version": "1.6.0"
              }
            ]
          },
          "configuration": [
            {
              "key": "ibmcloud_api_key"
            },
            {
              "key": "prefix",
              "type": "string",
              "default_value": "",
              "description": "The prefix to add to all resources created by this solution. Used to make sure that names are unique when you deploy the solution more than one time.",
              "required": true
            },
            {
              "key": "resource_group_name",
              "type": "string",
              "default_value": "default",
              "required": true
            },
            {
              "key": "region",
              "required": true,
              "options": [
                {
                  "displayname": "Dallas (us-south)",
                  "value": "us-south"
                },
                {
                  "displayname": "Frankfurt (eu-de)",
                  "value": "eu-de"
                },
                {
                  "displayname": "London (eu-gb)",
                  "value": "eu-gb"
                },
                {
                  "displayname": "Madrid (eu-es)",
                  "value": "eu-es"
                },
                {
                  "displayname": "Osaka (jp-osa)",
                  "value": "jp-osa"
                },
                {
                  "displayname": "Sydney (au-syd)",
                  "value": "au-syd"
                },
                {
                  "displayname": "Tokyo (jp-tok)",
                  "value": "jp-tok"
                },
                {
                  "displayname": "Washington (us-east)",
                  "value": "us-east"
                }
              ]
            },
            {
              "key": "log_analysis_provision"
            },
            {
              "key": "log_analysis_instance_name"
            },
            {
              "key": "log_analysis_plan",
              "options": [
                {
                  "displayname": "lite",
                  "value": "lite"
                },
                {
                  "displayname": "7-day",
                  "value": "7-day"
                },
                {
                  "displayname": "14-day",
                  "value": "14-day"
                },
                {
                  "displayname": "30-day",
                  "value": "30-day"
                },
                {
                  "displayname": "hipaa-30-day",
                  "value": "hipaa-30-day"
                }
              ]
            },
            {
              "key": "log_analysis_service_endpoints",
              "options": [
                {
                  "displayname": "public",
                  "value": "public"
                },
                {
                  "displayname": "private",
                  "value": "private"
                },
                {
                  "displayname": "public-and-private",
                  "value": "public-and-private"
                }
              ]
            },
            {
              "key": "log_analysis_tags"
            },
            {
              "key": "enable_log_archive"
            },
            {
              "key": "log_archive_api_key"
            },
            {
              "key": "enable_platform_logs"
            },
            {
              "key": "enable_at_event_routing_to_log_analysis"
            },
            {
              "key": "enable_at_event_routing_to_cos_bucket"
            },
            {
              "key": "cloud_monitoring_provision"
            },
            {
              "key": "existing_cloud_monitoring_crn"
            },
            {
              "key": "cloud_monitoring_instance_name"
            },
            {
              "key": "cloud_monitoring_plan",
              "options": [
                {
                  "displayname": "lite",
                  "value": "lite"
                },
                {
                  "displayname": "graduated-tier",
                  "value": "graduated-tier"
                }
              ]
            },
            {
              "key": "cloud_monitoring_service_endpoints",
              "options": [
                {
                  "displayname": "public",
                  "value": "public"
                },
                {
                  "displayname": "private",
                  "value": "private"
                },
                {
                  "displayname": "public-and-private",
                  "value": "public-and-private"
                }
              ]
            },
            {
              "key": "cloud_monitoring_tags"
            },
            {
              "key": "enable_platform_metrics"
            },
            {
              "key": "cos_instance_name"
            },
            {
              "key": "cos_instance_tags"
            },
            {
              "key": "cos_instance_access_tags"
            },
            {
              "key": "add_bucket_name_suffix"
            },
            {
              "key": "log_archive_cos_bucket_name"
            },
            {
              "key": "archive_bucket_access_tags"
            },
            {
              "key": "log_archive_cos_bucket_class",
              "options": [
                {
                  "displayname": "standard",
                  "value": "standard"
                },
                {
                  "displayname": "vault",
                  "value": "vault"
                },
                {
                  "displayname": "cold",
                  "value": "cold"
                },
                {
                  "displayname": "smart",
                  "value": "smart"
                },
                {
                  "displayname": "onerate_active",
                  "value": "onerate_active"
                }
              ]
            },
            {
              "key": "at_cos_target_bucket_name"
            },
            {
              "key": "at_cos_bucket_access_tags"
            },
            {
              "key": "at_cos_target_bucket_class",
              "options": [
                {
                  "displayname": "standard",
                  "value": "standard"
                },
                {
                  "displayname": "vault",
                  "value": "vault"
                },
                {
                  "displayname": "cold",
                  "value": "cold"
                },
                {
                  "displayname": "smart",
                  "value": "smart"
                },
                {
                  "displayname": "onerate_active",
                  "value": "onerate_active"
                }
              ]
            },
            {
              "key": "management_endpoint_type_for_bucket",
              "options": [
                {
                  "displayname": "public",
                  "value": "public"
                },
                {
                  "displayname": "private",
                  "value": "private"
                },
                {
                  "displayname": "direct",
                  "value": "direct"
                }
              ]
            },
            {
              "key": "existing_cos_instance_crn"
            },
            {
              "key": "existing_log_archive_cos_bucket_name"
            },
            {
              "key": "existing_log_archive_cos_bucket_endpoint"
            },
            {
              "key": "existing_at_cos_target_bucket_name"
            },
            {
              "key": "existing_at_cos_target_bucket_endpoint"
            },
            {
              "key": "skip_cos_kms_auth_policy"
            },
            {
              "key": "existing_cos_kms_key_crn",
              "required": true
            },
            {
              "key": "existing_kms_instance_crn",
              "type": "string",
              "default_value": "",
              "required": false
            },
            {
              "key": "cos_key_name"
            },
            {
              "key": "cos_key_ring_name"
            },
            {
              "key": "kms_endpoint_type",
              "options": [
                {
                  "displayname": "public",
                  "value": "public"
                },
                {
                  "displayname": "private",
                  "value": "private"
                }
              ]
            }
          ],
          "dependencies": [
            {
              "name": "testing-deploy-arch-ibm-kms",
              "id": "85fdbd7a-8c77-4abd-b716-653a31f3aba9",
              "version": "^1.0.1",
              "flavors": [
                "standard"
              ],
              "catalog_id": "f64499c8-eb50-4985-bf91-29f9e605a433",
              "optional": true,
              "input_mapping": [
                {
                  "dependency_output": "kms_instance_crn",
                  "version_input": "existing_kms_instance_crn"
                }
              ]
            },
            {
              "catalog_id": "7a4d68b4-cf8b-40cd-a3d1-f49aff526eb3",
              "flavors": [
                "standard"
              ],
              "id": "63641cec-6093-4b4f-b7b0-98d2f4185cd6-global",
              "input_mapping": [
                {
                  "dependency_output": "workload_resource_group_name",
                  "version_input": "existing_resource_group_name"
                },
                {
                  "dependency_input": "prefix",
                  "version_input": "prefix"
                }
              ],
              "name": "deploy-arch-ibm-account-infra-base",
              "optional": true,
              "version": "^1.11.6"
            }
          ],
          "dependency_version_2": true,
          "architecture": {

            "descriptions": "This architecture supports the deployment of IBM Log Analysis and IBM Cloud Monitoring instances on IBM Cloud. It also supports the deployment of IBM Cloud Activity Tracker Event Routing to an Object Storage bucket and Log Analysis target.",

            "features": [
              {
                "title": "Creates a Log Analysis instance",
                "description": "Creates and configures the IBM Cloud Log Analysis instance."
              },
              {
                "description": "Creates a Monitoring instance",
                "title": "Creates and configures the IBM Cloud Monitoring instance."
              },
              {
                "title": "Creates KMS-encrypted Object Storage buckets for log files and Activity Tracker events",
                "description": "Creates and configures the IBM Cloud Object Storage buckets with archiving and expiration enabled."
              },
              {
                "title": "Creates an IBM Cloud Activity Tracker event route to an Object Storage bucket and Log Analysis target",
                "description": "Creates and configures the IBM Cloud Activity Tracker Event Routing to an IBM Cloud Object Storage bucket and IBM Cloud Log Analysis target."
              }
            ],
            "diagrams": [
              {
                "diagram": {
                  "caption": "Observability instances on IBM Cloud",
                  "url": "https://raw.githubusercontent.com/terraform-ibm-modules/terraform-ibm-observability-da/main/reference-architecture/deployable-architecture-observability-instances.svg",
                  "type": "image/svg+xml"
                },

                "description": "This architecture supports creating and configuring IBM Cloud Observability instances and IBM Cloud Activity Tracker Event Routing to an Object Storage bucket and Log Analysis instance."

              }
            ]
          }
        },
        {
          "label": "Agents",
          "name": "agents",
          "install_type": "extension",
          "working_directory": "solutions/agents",
          "iam_permissions": [
            {
              "service_name": "containers-kubernetes",
              "role_crns": [
                "crn:v1:bluemix:public:iam::::serviceRole:Manager",
                "crn:v1:bluemix:public:iam::::role:Viewer"
              ]
            }
          ],
          "configuration": [
            {
              "key": "cloud_monitoring_access_key",
              "type": "password",
              "description": "The access key that is used by the IBM Cloud Monitoring agent to communicate with the instance.",
              "required": false
            },
            {
              "key": "cloud_monitoring_add_cluster_name",
              "type": "boolean",
              "default_value": true,
              "description": "Whether to attach a tag to log messages. Set to `true` to configure the IBM Cloud Monitoring agent to attach a tag that contains the cluster name to all log messages.",
              "required": false
            },
            {
              "key": "cloud_monitoring_agent_name",
              "type": "string",
              "default_value": "sysdig-agent",
              "description": "The name of the IBM Cloud Monitoring agent that is used to name the Kubernetes and Helm resources on the cluster. If a prefix input variable is passed, the name of the IBM Cloud Monitoring agent is prefixed to the value in the `<prefix>-<name>` format.",
              "required": false
            },
            {
              "key": "cloud_monitoring_agent_namespace",
              "type": "string",
              "default_value": "ibm-observe",
              "description": "The namespace to deploy the IBM Cloud Monitoring agent in. Default value: `ibm-observe`.",
              "required": false
            },
            {
              "key": "cloud_monitoring_agent_tags",
              "type": "array",
              "default_value": "[]",
              "description": "A list of the tags to associate with the metrics that the IBM Cloud Monitoring agent collects. To add the cluster name as a tag, use the `cloud_monitoring_add_cluster_name` variable.",
              "required": false
            },
            {
              "key": "cloud_monitoring_agent_tolerations",
              "type": "array",
              "default_value": "[{\n    operator = \"Exists\"\n    },\n    {\n      operator : \"Exists\"\n      effect : \"NoSchedule\"\n      key : \"node-role.kubernetes.io/master\"\n  }]",
              "description": "The list of tolerations to apply to the IBM Cloud Monitoring agent. The default operator value `Exists` matches any taint on any node except the master node. [Learn more](https://kubernetes.io/docs/concepts/scheduling-eviction/taint-and-toleration/)",
              "required": false
            },
            {
              "key": "cloud_monitoring_enabled",
              "type": "boolean",
              "default_value": true,
              "description": "Whether to deploy the IBM Cloud Monitoring agent.",
              "required": false
            },
            {
              "key": "cloud_monitoring_endpoint_type",
              "type": "string",
              "default_value": "private",
              "description": "Specify the IBM Cloud Monitoring instance endpoint type (`public` or `private`) to use to construct the ingestion endpoint.",
              "required": false
            },
            {
              "key": "cloud_monitoring_instance_region",
              "type": "string",
              "default_value": "__NULL__",
              "description": "The name of the region where the IBM Cloud Monitoring instance is created. This name is used to construct the ingestion endpoint.",
              "required": false
            },
            {
              "key": "cloud_monitoring_metrics_filter",
              "type": "array",
              "default_value": "[]",
              "description": "To filter on custom metrics, specify the IBM Cloud Monitoring metrics to include or exclude. [Learn more](https://cloud.ibm.com/docs/monitoring?topic=monitoring-change_kube_agent#change_kube_agent_inc_exc_metrics)",
              "required": false
            },
            {
              "key": "cloud_monitoring_secret_name",
              "type": "string",
              "default_value": "sysdig-agent",
              "description": "The name of the secret that will store the access key. If a prefix input variable is passed, the secret name is prefixed to the value in the `<prefix>-<name>` format.",
              "required": false
            },
            {
              "key": "cluster_config_endpoint_type",
              "type": "string",
              "default_value": "private",
              "description": "Specify the type of endpoint to use to access the cluster configuration. Possible values: `default`, `private`, `vpe`, `link`. The `default` value uses the default endpoint of the cluster.",
              "required": false
            },
            {
              "key": "cluster_id",
              "type": "string",
              "default_value": "__NOT_SET__",
              "description": "The ID of the cluster to deploy the agents in.",
              "required": true
            },
            {
              "key": "cluster_resource_group_id",
              "type": "string",
              "default_value": "__NOT_SET__",
              "description": "The resource group ID of the cluster.",
              "required": true
            },
            {
              "key": "ibmcloud_api_key",
              "type": "password",
              "description": "The IBM Cloud API key.",
              "required": true
            },
            {
              "key": "log_analysis_add_cluster_name",
              "type": "boolean",
              "default_value": true,
              "description": "Whether to attach the cluster name to log messages. Set to `true` to configure the IBM Log Analysis agent to tag all log messages with the name.",
              "required": false
            },
            {
              "key": "log_analysis_agent_custom_line_exclusion",
              "type": "string",
              "default_value": "__NULL__",
              "description": "The custom configuration of the IBM Log Analysis agent for the `LOGDNA_K8S_METADATA_LINE_INCLUSION` line exclusion setting. [Learn more](https://github.com/logdna/logdna-agent-v2/blob/master/docs/KUBERNETES.md#configuration-for-kubernetes-metadata-filtering)",
              "required": false
            },
            {
              "key": "log_analysis_agent_custom_line_inclusion",
              "type": "string",
              "default_value": "__NULL__",
              "description": "The custom configuration of the IBM Log Analysis agent for the `LOGDNA_K8S_METADATA_LINE_INCLUSION` line inclusion setting. [Learn more](https://github.com/logdna/logdna-agent-v2/blob/master/docs/KUBERNETES.md#configuration-for-kubernetes-metadata-filtering)",
              "required": false
            },
            {
              "key": "log_analysis_agent_name",
              "type": "string",
              "default_value": "logdna-agent",
              "description": "The name of the IBM Log Analysis agent that is used to name the Kubernetes and Helm resources on the cluster. If a prefix input variable is passed, the name of the IBM Log Analysis agent is prefixed to the value in the `<prefix>-<name>` format.",
              "required": false
            },
            {
              "key": "log_analysis_agent_namespace",
              "type": "string",
              "default_value": "ibm-observe",
              "description": "The namespace to deploy the IBM Log Analysis agent in. The default value of the namespace is `ibm-observe`.",
              "required": false
            },
            {
              "key": "log_analysis_agent_tags",
              "type": "array",
              "default_value": "[]",
              "description": "The list of tags to associate with all log records collected by the agent so that you can quickly identify the agentâ€™s data in the logging UI. To add the cluster name as a tag, use the `log_analysis_add_cluster_name` variable.",
              "required": false
            },
            {
              "key": "log_analysis_agent_tolerations",
              "type": "array",
              "default_value": "[{\n    operator = \"Exists\"\n  }]",
              "description": "The list of tolerations to apply to the IBM Log Analysis agent. Because the default value is the `Exists` operator, this variable will match any taint on any node. [Learn more](https://kubernetes.io/docs/concepts/scheduling-eviction/taint-and-toleration/)",
              "required": false
            },
            {
              "key": "log_analysis_enabled",
              "type": "boolean",
              "default_value": true,
              "description": "Whether to deploy the IBM Cloud logging agent.",
              "required": false
            },
            {
              "key": "log_analysis_endpoint_type",
              "type": "string",
              "default_value": "private",
              "description": "Specify the IBM Log Analysis instance endpoint type to use to construct the ingestion endpoint. Possible values: `public` or `private`.",
              "required": false
            },
            {
              "key": "log_analysis_ingestion_key",
              "type": "password",
              "description": "The ingestion key that is used by the IBM Cloud logging agent to communicate with the instance.",
              "required": false
            },
            {
              "key": "log_analysis_instance_region",
              "type": "string",
              "default_value": "__NULL__",
              "description": "The name of the region where the IBM Log Analysis instance is created. The value is used in the ingestion endpoint in the format `api.<var-value>.logging.cloud.ibm.com`.",
              "required": false
            },
            {
              "key": "log_analysis_secret_name",
              "type": "string",
              "default_value": "logdna-agent",
              "description": "The name of the secret that stores the ingestion key. If a prefix input variable is specified, the secret name is prefixed to the value in the `<prefix>-<name>` format.",
              "required": false
            },
            {
              "key": "prefix",
              "type": "string",
              "default_value": "__NULL__",
              "description": "The prefix for resources created by this solution.",
              "required": false
            }
          ],
          "dependencies": [
            {
              "name": "testing-deploy-arch-ibm-observability",
              "flavors": [
                "instances"
              ],
              "id": "daf2cf91-2384-4205-b7f4-621299a4896d",
              "version": "^1.0.7",
              "catalog_id": "f64499c8-eb50-4985-bf91-29f9e605a433",
              "optional": true,
              "input_mapping": [
                {
                  "dependency_input": "log_analysis_provision",
                  "version_input": "log_analysis_enabled"
                },
                {
                  "dependency_output": "log_analysis_ingestion_key",
                  "version_input": "log_analysis_ingestion_key"
                },
                {
                  "dependency_input": "cloud_monitoring_provision",
                  "version_input": "cloud_monitoring_enabled"
                }
              ]
            }
          ],
          "dependency_version_2": true,
          "architecture": {
            "descriptions": "This architecture supports the deployment of IBM Log Analysis and IBM Cloud Monitoring agents on an existing Red Hat OpenShift cluster on a secure landing zone.",
            "features": [
              {
                "title": "Works with the secure landing zone.",
                "description": "Works with the Red Hat OpenShift cluster on a secure landing zone."
              },
              {
                "title": "Deploys the IBM Log Analysis agent on an existing cluster on a secure landing zone.",
                "description": "Deploys the IBM Log Analysis agent on an existing Red Hat OpenShift cluster on a secure landing zone."
              },
              {
                "title": "Deploys the IBM Cloud Monitoring agent on an existing cluster on a secure landing zone.",
                "description": "Deploys the IBM Cloud Monitoring agent on an existing Red Hat OpenShift cluster on a secure landing zone."
              }
            ],
            "diagrams": [
              {
                "diagram": {
                  "caption": "Observability agents on a Red Hat OpenShift cluster",
                  "url": "https://raw.githubusercontent.com/terraform-ibm-modules/terraform-ibm-observability-da/main/reference-architecture/deployable-architecture-observability-agents.svg",
                  "type": "image/svg+xml"
                },
                "description": "Observability agents deployed on a Red Hat OpenShift cluster on a secure landing zone."
              }
            ]
          }
        }
      ]
    }
  ]
}
